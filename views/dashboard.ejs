<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .sidebar {
      background-color: #f8f9fa;
      padding: 20px;
      height: 100vh;
      border-right: 1px solid #dee2e6;
    }

    .sidebar a {
      display: block;
      padding: 10px 0;
      color: #495057;
      text-decoration: none;
    }

    .sidebar a.active {
      font-weight: bold;
      color: #007bff;
    }
  </style>
  <script>    
  // Deshabilitar clic derecho
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
    });

    // Deshabilitar teclas de inspección
    document.addEventListener('keydown', function(e) {
      // Deshabilitar F12
      if (e.key === 'F12') {
        e.preventDefault();
      }
      
      // Deshabilitar Ctrl+Shift+I
      if (e.ctrlKey && e.shiftKey && e.key === 'I') {
        e.preventDefault();
      }
      
      // Deshabilitar Ctrl+Shift+C
      if (e.ctrlKey && e.shiftKey && e.key === 'C') {
        e.preventDefault();
      }
      
      // Deshabilitar Ctrl+Shift+J
      if (e.ctrlKey && e.shiftKey && e.key === 'J') {
        e.preventDefault();
      }
      
      // Deshabilitar Ctrl+U (ver código fuente)
      if (e.ctrlKey && e.key === 'u') {
        e.preventDefault();
      }
    });

    // Deshabilitar el clic derecho y las teclas de inspección también en el iframe
    window.onload = function() {
      var iframe = document.getElementById('content-iframe');
      if (iframe) {
        iframe.onload = function() {
          try {
            iframe.contentWindow.document.addEventListener('contextmenu', function(e) {
              e.preventDefault();
            });
            
            iframe.contentWindow.document.addEventListener('keydown', function(e) {
              if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
                e.preventDefault();
              }
            });
          } catch(e) {
            console.log('No se pueden aplicar restricciones al iframe debido a la política del mismo origen');
          }
        };
      }
    };
</script>
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <span class="navbar-brand">
        Bienvenido <%= user.display_name %>
        <small class="text-muted">(<%= user.username %>)</small>
      </span>
      <a href="/logout" class="btn btn-outline-light">Cerrar Sesión</a>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <div class="col-1 sidebar">
        <a href="/alta" id="link-alta" class="active">Alta</a>
        <% if(user.full_access){ %>
          <a href="/baja" id="link-baja" class="active">Baja</a>
        <% } %>
      </div>
      <div class="col-11 mt-4">
        <div class="ratio ratio-16x9">
          <iframe id="content-iframe" 
                  src="<%= iframe %>" 
                  allowfullscreen
                  sandbox="allow-same-origin allow-scripts allow-forms">
          </iframe>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
